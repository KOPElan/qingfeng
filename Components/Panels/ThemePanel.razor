@using Microsoft.FluentUI.AspNetCore.Components

<div class="theme-panel-content">
    <FluentDivider Style="margin: calc(var(--design-unit) * 2px) 0;" />

    <div class="theme-option">
        <div class="theme-option-info">
            <div class="theme-option-title">ä¸»é¢˜æ¨¡å¼</div>
            <div class="theme-option-description">é€‰æ‹©äº®è‰²ã€æš—è‰²æˆ–è·Ÿéšç³»ç»Ÿ</div>
        </div>
        <FluentSelect TOption="string"
                      Items="@themeModes"
                      OptionText="@(item => item switch 
                      {
                          "Light" => "â˜€ï¸ äº®è‰²",
                          "Dark" => "ğŸŒ™ æš—è‰²",
                          "System" => "ğŸ’» è·Ÿéšç³»ç»Ÿ",
                          _ => item
                      })"
                      OptionValue="@(item => item)"
                      Value="@CurrentMode"
                      ValueChanged="@OnThemeModeChanged"
                      Style="width: 150px;" />
    </div>

    <div class="theme-option">
        <div class="theme-option-info">
            <div class="theme-option-title">ä¸»é¢˜è‰²</div>
            <div class="theme-option-description">é€‰æ‹©æ‚¨å–œæ¬¢çš„ä¸»è‰²è°ƒ</div>
        </div>
        <FluentSelect TOption="string"
                      Items="@officeColors"
                      OptionText="@(item => item)"
                      OptionValue="@(item => item)"
                      Value="@CurrentOfficeColor"
                      ValueChanged="@OnOfficeColorChanged"
                      Style="width: 150px;" />
    </div>

    <FluentDivider Style="margin: calc(var(--design-unit) * 2px) 0;" />

    <FluentLabel Typo="Typography.Body" Style="color: var(--neutral-foreground-hint); font-size: calc(var(--type-ramp-base-font-size) * 0.875);">
        ä¸»é¢˜è®¾ç½®ä¼šè‡ªåŠ¨ä¿å­˜å¹¶åº”ç”¨åˆ°æ‰€æœ‰é¡µé¢
    </FluentLabel>
</div>

@code {
    [Parameter]
    public DesignThemeModes Mode { get; set; } = DesignThemeModes.System;

    [Parameter]
    public EventCallback<DesignThemeModes> ModeChanged { get; set; }

    [Parameter]
    public OfficeColor? OfficeColor { get; set; } = Microsoft.FluentUI.AspNetCore.Components.OfficeColor.Default;

    [Parameter]
    public EventCallback<OfficeColor?> OfficeColorChanged { get; set; }

    private string CurrentMode => Mode.ToString();

    private string CurrentOfficeColor => OfficeColor?.ToString() ?? "Default";

    private static readonly string[] themeModes = new[] { "Light", "Dark", "System" };
    
    private static readonly string[] officeColors = Enum.GetNames(typeof(OfficeColor));

    private async Task OnThemeModeChanged(string mode)
    {
        if (Enum.TryParse<DesignThemeModes>(mode, out var modeEnum))
        {
            Mode = modeEnum;
            await ModeChanged.InvokeAsync(modeEnum);
        }
    }

    private async Task OnOfficeColorChanged(string color)
    {
        if (Enum.TryParse<OfficeColor>(color, out var colorEnum))
        {
            OfficeColor = colorEnum;
            await OfficeColorChanged.InvokeAsync(colorEnum);
        }
    }
}
